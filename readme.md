This respository contains code to produce geographical simulations of Cornish and Welsh over the time periods considered in the study.

The pipeline is as follows:
1. Obtain shapefiles of regions and census Output Areas from UK Gov website. For example, `wales_mask.npy` (`cornwall_mask.tif`) contains the shape for Wales (Cornwall) and neighbouring parts of England (the binary mask used to determine the region over which the simulation is performed) and `wales_pop_dist.npy` (`cornwall_pop_dist.npy`) contains the population for each region (for methodological reasons each pixel of the element in the array contains the population of the region that element is in). 
2. Following the method from Burridge, smooth the population distribution by replacing the population in each Output Area with a Gaussian distribution, with population falling outside the region iteratively redistributed so the total population is preserved. This is done using `smooth_population.py` and the resulting file is called `wales_smoothed_dist_ss10.npy` (`ss` referring to Ïƒ_s).
3. The simulation carried out with `simulate_wales.py` (`simulate_cornwall.py`), using the population distribution generated above, the initial condition `wales_initial_1850.npy` (`cornwall_river_mask.npy`) and the region masks. The initial conditions were manually created Snapshots are saved in an automatically generated folder every `saveInterval` iterations. The simulation can be very intensive depending on hyperparams, timestep etc. (HPC was used to create the figures in the report).
4. Figures are plotted and comparisons made to historical data using the various files in the repo (`/data`). Other masks (e.g. `cornwall_mask_w_border.npy` and `wales_country_mask_tif.tif`) are used for creating figures.
